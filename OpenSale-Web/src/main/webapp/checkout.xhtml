<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">

    <body>

        <ui:composition template="./OpenSaleTemplate.xhtml">

            <ui:define name="PageTitle">
                Checkout
            </ui:define>

            <ui:define name="navBar">
                <div class="brand">Checkout</div>
            </ui:define>

            <ui:define name="content">
                <div id="userList" class="span8 offset2"> 
                    <p:outputPanel autoUpdate="true">
                        <h:form>                        
                            <p:dataTable value="#{transactionBean.currentTransaction.items}"
                                         var="rowuser"
                                         rowStyleClass="#{rowuser.isVoided ? 'voided' : null}"
                                         editable="false"
                                         widgetVar="transactionTable">                                                        

                                <p:column headerText="Item Name">                                
                                    <h:outputText value="#{rowuser.product.productName}"/>
                                </p:column>

                                <p:column headerText="Price">                                
                                    <h:outputText value="#{rowuser.product.price}">
                                        <f:convertNumber type="currency"/>
                                    </h:outputText>
                                </p:column>

                                <p:column headerText="Quantity">
                                    <h:outputText value="#{rowuser.quantity}"/>                                    
                                </p:column>

                                <p:column headerText="Purchased Weight">                                    
                                    <h:outputText value="#{rowuser.purchasedWeight}"/>                                        
                                </p:column>


                                <f:facet name="footer">
                                    Your total is 
                                    <h:outputText value="#{transactionBean.currentTransaction.generateTotal()}"
                                                  id="total">
                                        <f:convertNumber type="currency"/>
                                    </h:outputText>                                
                                </f:facet>

                            </p:dataTable>
                        </h:form>
                    </p:outputPanel>
                    <h:form>
                        <h:button outcome="transaction" 
                                  value="Back"
                                  class="btn"/>     

                        <p:separator />  

                        <h4>Payment Type:</h4>
                        <p:selectOneButton value="#{checkoutBean.paymentType}" style="margin: 10px"
                                           widgetVar="paymentTypeBtn">  
                            <f:selectItem itemLabel="Cash" itemValue="Cash" />  
                            <f:selectItem itemLabel="Paypal" itemValue="Paypal" />  
                            <f:selectItem itemLabel="Credit Card" itemValue="CreditCard"/>
                            <f:selectItem itemLabel="Check" itemValue="Check" />
                            <f:validateRequired/>                            
                        </p:selectOneButton>  
                        
                        <p:outputPanel autoUpdate="true" id="cardInfo">
                            <p:outputPanel rendered="#{paymentType}">
                                <p:outputLabel for="creditCardNumberInput" value="Card number: "/>
                                <p:inputText value="#{checkoutBean.creditCardNumber}" id="creditCardNumberInput">
                                    <f:validateRequired/>
                                </p:inputText>                            
                            </p:outputPanel>
                        </p:outputPanel>
                        
                        <p:separator />

                        <h:commandButton action="#{checkoutBean.submit}"
                                         value="Submit" class="btn btn-primary"/>  
                    </h:form>

                </div> 
            </ui:define>

        </ui:composition>

    </body>
</html>
